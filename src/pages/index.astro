---
import About from "../components/About.astro";
import Contact from "../components/Contact.astro";
import Experience from "../components/Experience.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import Projects from "../components/Projects.astro";
import TechStack from "../components/TechStack.astro";
import Layout from "../layouts/Layout.astro";
import LanguageDetector from "../components/LanguageDetector.astro";
import { getTranslations, type Language } from "../i18n/translations";

import "../styles/global.css";

// Get language from URL param or cookie or default to Spanish
const urlLang = Astro.url.searchParams.get("lang") as Language | null;
const cookieLang = Astro.cookies.get("lang")?.value as Language | undefined;

// If URL has lang param, save it to cookie
if (urlLang && ["es", "en"].includes(urlLang)) {
  Astro.cookies.set("lang", urlLang, {
    path: "/",
    maxAge: 60 * 60 * 24 * 365, // 1 year
  });
}

const lang: Language = urlLang || cookieLang || "es";
const t = getTranslations(lang);
---

<Layout title="Sergio Barreras | Full Stack Developer">
  <LanguageDetector />
  <Header lang={lang} />
  <main>
    <Hero lang={lang} />
    <About lang={lang} />
    <Experience lang={lang} />
    <Projects lang={lang} />
    <TechStack lang={lang} />
    <Contact lang={lang} />
  </main>
  <Footer lang={lang} />
</Layout>
