<header
  id="main-header"
  class="fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 border-b border-slate-200 animate-fade-in-down transition-transform duration-300"
>
  <nav class="max-w-6xl mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <!-- LOGO/NAME -->
      <a
        href="#home"
        class="text-xl font-bold text-slate-900 hover:text-teal-700 transition-colors focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2 rounded"
      >
        Sergio <span class="text-teal-900">Barreras</span>
      </a>

      <!-- DESKTOP NAVIGATION -->
      <ul class="hidden md:flex items-center gap-8">
        <li>
          <a
            href="#about"
            class="text-slate-600 hover:text-teal-900 transition-all hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2 rounded px-2 py-1"
            >Sobre mí
          </a>
        </li>
        <li>
          <a
            href="#experience"
            class="text-slate-600 hover:text-teal-900 transition-all hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2 rounded px-2 py-1"
            >Experiencia
          </a>
        </li>
        <li>
          <a
            href="#projects"
            class="text-slate-600 hover:text-teal-900 transition-all hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2 rounded px-2 py-1"
            >Proyectos
          </a>
        </li>
        <li>
          <a
            href="#tech"
            class="text-slate-600 hover:text-teal-900 transition-all hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2 rounded px-2 py-1"
            >Tecnologías
          </a>
        </li>
        <li>
          <a
            href="#contact"
            class="px-5 py-2 bg-teal-900 text-white rounded-lg hover:bg-teal-800 transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-teal-900 focus:ring-offset-2"
            >Contacto
          </a>
        </li>
      </ul>

      <!-- MOBILE MENU BUTTON -->
      <button
        id="menu-toggle"
        class="md:hidden p-3 -mr-3 text-slate-600 hover:text-teal-900 active:bg-slate-100 rounded-lg transition-colors touch-manipulation"
        aria-label="Toggle Menu"
        aria-expanded="false"
      >
        <svg
          id="menu-icon"
          class="w-6 h-6 transition-transform duration-200"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- MOBILE MENU -->

    <div
      id="mobile-menu"
      class="hidden md:hidden pt-6 pb-4 animate-fade-in-down"
    >
      <ul class="flex flex-col gap-2">
        <li>
          <a
            href="#about"
            class="block text-slate-600 hover:text-teal-900 hover:bg-teal-50 transition-all px-4 py-3 rounded-lg font-medium active:bg-teal-100 touch-manipulation"
            >Sobre mí
          </a>
        </li>
        <li>
          <a
            href="#experience"
            class="block text-slate-600 hover:text-teal-900 hover:bg-teal-50 transition-all px-4 py-3 rounded-lg font-medium active:bg-teal-100 touch-manipulation"
            >Experiencia
          </a>
        </li>
        <li>
          <a
            href="#projects"
            class="block text-slate-600 hover:text-teal-900 hover:bg-teal-50 transition-all px-4 py-3 rounded-lg font-medium active:bg-teal-100 touch-manipulation"
            >Proyectos
          </a>
        </li>
        <li>
          <a
            href="#tech"
            class="block text-slate-600 hover:text-teal-900 hover:bg-teal-50 transition-all px-4 py-3 rounded-lg font-medium active:bg-teal-100 touch-manipulation"
            >Tecnologías
          </a>
        </li>
        <li>
          <a
            href="#contact"
            class="block text-white bg-teal-900 hover:bg-teal-800 transition-all px-4 py-3 rounded-lg font-medium text-center active:bg-teal-700 touch-manipulation"
            >Contacto
          </a>
        </li>
      </ul>
    </div>
  </nav>
</header>

<script>
  const menuToggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const header = document.getElementById("main-header");

  // Mobile menu toggle with animation and accessibility
  menuToggle?.addEventListener("click", () => {
    const isHidden = mobileMenu?.classList.contains("hidden");
    if (isHidden) {
      mobileMenu?.classList.remove("hidden");
      setTimeout(() => mobileMenu?.classList.add("animate-fade-in-down"), 10);
      menuToggle?.setAttribute("aria-expanded", "true");
      // Prevent body scroll when menu is open
      document.body.style.overflow = "hidden";
    } else {
      mobileMenu?.classList.add("hidden");
      menuToggle?.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    }
  });

  // Close mobile menu on link click
  const mobileLinks = mobileMenu?.querySelectorAll("a");
  mobileLinks?.forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu?.classList.add("hidden");
      menuToggle?.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    });
  });

  // Close mobile menu on escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && !mobileMenu?.classList.contains("hidden")) {
      mobileMenu?.classList.add("hidden");
      menuToggle?.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    }
  });

  // Close mobile menu when clicking outside
  document.addEventListener("click", (e) => {
    const target = e.target as Node;
    if (
      !mobileMenu?.classList.contains("hidden") &&
      !mobileMenu?.contains(target) &&
      !menuToggle?.contains(target)
    ) {
      mobileMenu?.classList.add("hidden");
      menuToggle?.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    }
  });

  // Hide header on scroll down, show on scroll up
  let lastScroll = 0;
  window.addEventListener("scroll", () => {
    const currentScroll = window.scrollY;

    if (currentScroll <= 100) {
      header?.classList.remove("-translate-y-full");
      return;
    }

    if (currentScroll > lastScroll && currentScroll > 100) {
      // Scrolling down
      header?.classList.add("-translate-y-full");
    } else {
      // Scrolling up
      header?.classList.remove("-translate-y-full");
    }

    lastScroll = currentScroll;
  });

  // Highlight active section in navigation
  const sections = document.querySelectorAll("section[id]");
  const navLinks = document.querySelectorAll("nav a[href^='#']");

  function highlightNav() {
    let current = "";
    sections.forEach((section) => {
      if (section instanceof HTMLElement) {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (window.scrollY >= sectionTop - 200) {
          current = section.getAttribute("id") || "";
        }
      }
    });

    navLinks.forEach((link) => {
      link.classList.remove("text-teal-900", "font-semibold");
      if (link.getAttribute("href") === `#${current}`) {
        link.classList.add("text-teal-900", "font-semibold");
      }
    });
  }

  window.addEventListener("scroll", highlightNav);
</script>
